<!DOCTYPE html>
<html>

<head>
    <title>Food Bank Listing | FreeFood4U</title>
    <link rel="icon" href="logo.ico" type="image/ico">
    <link rel="stylesheet" href="style/foodBankResult.css">
    <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-firestore.js"></script>
    <script src="https://kit.fontawesome.com/166358a2b4.js" crossorigin="anonymous"></script>
    <script src="script/firebase.js"></script>
    <script src="script/firestore.js"></script>
    <script>
        window.onload = async function () {
            const container = document.getElementById("cardContainer");

            const docs = await getFoodBanks();
            const list = docs.map(e => e.data()).reverse();

            container.innerHTML = list.map(user =>
                `
                <div class="card" id="card">
                    <div class="top-menu">
                        <i class="fas fa-ellipsis-h"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-mainImage">
                            <img src="images/userIcon.png" alt="" class="profile-img">
                        </div>
                        <div class="card-text">
                            <h2 class="card-title">${user.name}</h2>
                            <p class="card-desc">
                                ${user.desc}
                            </p>
                        </div>
                        <div class="card-info">
                            <div class="detail">
                                <i class="fas fa-utensils"></i>
                                <p> Category: ${user.category}</p>
                            </div>
                            <div class="detail">
                                <i class="fas fa-clock"></i>
                                <p> Distribution time: ${user.dist_time}</p>
                            </div>
                            <div class="detail">
                                <i class="fas fa-compass"></i>
                                <p> Address: ${user.address}, ${user.district}, ${user.state}</p>
                            </div>
                            <div class="detail">
                                <i class="fas fa-phone"></i>
                                <p> Phone: ${user.phone}</p>
                            </div>
                            <div class="detail">
                                <i class="fas fa-check-circle"></i>
                                <p> Status: ${user.availability ? 'Available' : 'Not available'}</p>
                            </div>
                        </div>
                    </div>
                </div>
                `
            ).join("");

        }

        /* When the user clicks on the button,
        toggle between hiding and showing the dropdown content */
        function myFunction() {
            document.getElementById("myDropdown").classList.toggle("show");
        }

        // Close the dropdown menu if the user clicks outside of it
        window.onclick = function (event) {
            if (!event.target.matches('.dropbtn')) {
                var dropdowns = document.getElementsByClassName("dropdown-content");
                var i;
                for (i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        }
    </script>
</head>

<body>
    <div class="back">
        <i class="fas fa-chevron-left" style="padding: 2vh; font-size: 50px; cursor: pointer;"
            onclick="javascript:location.href='searchBank.html';"></i>
    </div>
    <div class="container">
        <header>
            <h1>Food Bank Near You</h1>
        </header>

        <div class="search-banner">
            <div class="dropdown">
                <button onclick="myFunction()" class="dropbtn">State</button>
                <div id="myDropdown" class="dropdown-content">
                    <a href="#">Link 1</a>
                    <a href="#">Link 2</a>
                    <a href="#">Link 3</a>
                </div>
            </div>
    
            <div class="dropdown">
                <button onclick="myFunction()" class="dropbtn">Area</button>
                <div id="myDropdown" class="dropdown-content">
                    <a href="#">Link 1</a>
                    <a href="#">Link 2</a>
                    <a href="#">Link 3</a>
                </div>
            </div>
        </div>
        
        <div class="card-container" id="cardContainer"></div>
    </div>
</body>

</html>